const doc=document,rootEl=doc.documentElement,body=doc.body,lightSwitch=doc.getElementById("lights-toggle"),sr=window.sr=ScrollReveal();rootEl.classList.remove("no-js"),rootEl.classList.add("js"),window.addEventListener("load",function(){body.classList.add("is-loaded")});let form=document.getElementById("sheetdb-form");function validateForm(){let e=document.getElementById("first-name").value,t=document.getElementById("last-name").value,o=document.getElementById("phone").value;const n=[e,t,o,document.getElementById("order-cities").value,document.getElementById("order-warehouses").value];return o.length<12?(alert("Невірний номер телефону"),!1):!n.some(e=>!e)||(alert("Заповніть всі необхідні поля"),!1)}function revealAnimations(){sr.reveal(".feature",{duration:600,distance:"20px",easing:"cubic-bezier(0.215, 0.61, 0.355, 1)",origin:"right",viewFactor:.2})}function checkLights(){let e=lightSwitch.parentNode.querySelector(".label-text");lightSwitch.checked?(body.classList.remove("lights-off"),e&&(e.innerHTML="світла")):(body.classList.add("lights-off"),e&&(e.innerHTML="темна"))}async function initForm(){$("#warehouses").hide(),$("#order-cities").select2({width:"100%",placeholder:"Виберіть місто",minimumInputLength:3,templateResult:formatResults,ajax:{url:"https://api.novaposhta.ua/v2.0/json/",dataType:"json",method:"POST",data:function(e){return JSON.stringify({apiKey:"aabcf7c7457fed2937fc69e37d77369d",modelName:"Address",calledMethod:"getSettlements",methodProperties:{Page:1,Warehouse:1,Limit:10,FindByString:e.term}})},processResults:function(e){if(e.success){return{results:e.data.map(e=>({id:e.Ref,text:e.Description+", "+e.AreaDescription}))}}return null}}}),$("#order-cities").on("select2:select",function(e){const t={apiKey:"aabcf7c7457fed2937fc69e37d77369d",modelName:"Address",calledMethod:"getWarehouses",methodProperties:{Page:1,Warehouse:1,Limit:10,SettlementRef:e.target.value}};$('input[name="city"]').val($("#order_city_dropdown option:selected").text()),fetch("https://api.novaposhta.ua/v2.0/json/",{method:"POST",body:JSON.stringify(t)}).then(e=>{e.ok||422!==e.status?e.json().then(e=>{let t=e.data.map(e=>({id:e.Description,text:e.Description}));$("#warehouses").fadeIn(),$("#order-warehouses").html("").select2({width:"100%",placeholder:"Номер відділення",disabled:!1,data:t})}):console.log("error",e)}).catch(e=>{console.log(e)})})}function formatResults(e){return e.text?e.text:"Пошук..."}form.addEventListener("submit",e=>{if(e.preventDefault(),!validateForm())return;const t=new FormData(document.getElementById("sheetdb-form"));t.set("data[City]",$("#order-cities option:selected").text()),fetch(form.action,{method:"POST",body:t}).then(e=>e.json()).then(()=>{console.log("OK"),alert("Замовлення прийняте!"),window.scrollTo({top:0,left:0})})}),body.classList.contains("has-animations")&&window.addEventListener("load",revealAnimations),lightSwitch&&(window.addEventListener("load",checkLights),lightSwitch.addEventListener("change",checkLights)),initForm();